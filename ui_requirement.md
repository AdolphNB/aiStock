# 股票助手软件 UI 需求文档

## 1. 文档说明
- **项目名称**：股票助手 (AiStockMonitor)
- **文档版本**：1.0.0
- **依赖文档**：`requirement.md`
- **UI 框架**：PyQt6
- **描述**：本文档详细描述了股票助手软件的用户界面设计需求，旨在提供一个清晰、高效且专业的交互界面。

## 2. 总体设计原则
- **布局风格**：采用经典的金融终端布局，强调信息密度与可读性的平衡。
- **色彩主题**：支持 **明亮 (Light)** 和 **暗黑 (Dark)** 两种风格切换。默认跟随系统或由用户在配置中指定。
- **交互体验**：
    - 响应迅速，避免界面卡顿。
    - 关键区域支持拖拽调整大小（使用 `QSplitter`）。
    - 关键操作提供快捷键支持。

## 3. 主窗口设计
- **标题栏**：显示软件名称及版本号。
- **菜单栏**：包含“文件”、“视图”、“工具”、“帮助”等常用菜单。
- **状态栏**：底部显示当前网络连接状态、数据源API连接状态、LLM服务连接状态及当前时间。
- **主体区域**：使用 `QTabWidget` 实现三个主要功能区的切换：
    1. **交易监控**
    2. **智能选股**
    3. **系统配置**

## 4. 详细功能区设计

### 4.1 选项卡 1：交易监控 (Trading Monitor)
此页面为用户核心工作台，采用 **三栏式布局**（左、中、右），各栏之间使用可调节宽度的分割线。

#### 4.1.1 左侧区域：行情与个股 (约占 25%)
- **布局**：垂直分割为上下两部分。
- **上部：自选股列表 (Watchlist)**
    - **组件**：`QTableWidget` 或 `QTableView`。
    - **列信息**：代码、名称、最新价、涨跌幅、涨跌额、成交量。
    - **交互**：
        - 支持右键菜单：添加/删除自选、置顶、设置预警。
        - 单击某行：联动更新下方的K线预览和中间的LLM上下文。
        - 涨跌幅根据正负值显示红/绿颜色（遵循A股红涨绿跌习惯）。
- **下部：个股K线预览 (Mini Chart)**
    - **组件**：嵌入式绘图组件（如 `pyqtgraph` 或 `QWebEngineView` 加载 ECharts）。
    - **功能**：显示选中股票的日K线或分时图，提供简单的缩放功能。

#### 4.1.2 中间区域：LLM 智能助手 (约占 45%)
- **功能**：专注于当前选中股票的实时分析与对话。
- **布局**：垂直布局。
- **上部：对话历史窗口**
    - **组件**：`QTextBrowser` 或自定义列表视图。
    - **展示**：区分用户提问与 LLM 回答，支持 Markdown 渲染（用于显示表格、加粗关键数据）。
- **下部：输入控制区**
    - **组件**：多行输入框 (`QTextEdit`) + 发送按钮 + 功能按钮组。
    - **功能按钮**：
        - “分析当前股票”：一键发送当前选中股票的分析指令。
        - “生成交易策略”：请求 LLM 基于当前行情给出策略。
        - “清空历史”。

#### 4.1.3 右侧区域：监控与预警 (约占 30%)
- **功能**：实时展示策略监控结果和系统通知。
- **布局**：垂直布局。
- **组件**：
    - **监控面板**：显示正在运行的监控策略列表及其状态（运行中/暂停）。
    - **消息日志流**：`QListWidget` 或 `QTableWidget`。
        - 实时滚动显示触发的信号（如：“000001 平安银行 突破20日均线”）。
        - 包含时间戳、股票代码、触发策略、信号详情。
        - 不同级别的消息（信息、警告、错误）使用不同颜色标记。

### 4.2 选项卡 2：智能选股 (Smart Selection)
此页面用于发现投资机会，采用 **两栏式布局**。

#### 4.2.1 左侧区域：市场全景 (约占 60%)
- **布局**：包含选项卡或树状导航。
- **模块**：
    - **板块/指数概览**：树状图展示行业板块、概念板块及其涨跌幅。
    - **板块成分股**：点击板块后，在下方表格显示成分股详情。
    - **数据筛选器**：提供基础指标筛选界面（如：市盈率 < 20, 涨幅 > 3%）。
- **交互**：选中某板块或股票组后，可将其作为上下文发送给右侧 LLM。

#### 4.2.2 右侧区域：选股助手 (约占 40%)
- **功能**：通过自然语言辅助选股。
- **组件**：
    - **对话窗口**：同交易监控页面的对话组件，但上下文侧重于全市场数据。
    - **预设指令集**（快捷按钮）：
        - “分析今日热门板块”
        - “筛选低估值蓝筹股”
        - “解读当前市场情绪”
- **结果展示**：LLM 返回的选股结果应能解析为结构化数据，并提供“一键加入自选”功能。

### 4.3 选项卡 3：系统配置 (Configuration)
此页面用于管理软件参数，采用 **左右两栏式布局**。

#### 4.3.1 左侧区域：LLM 核心配置
此区域负责管理大模型相关的基础设施，支持多供应商和多提示词模板的管理。

- **大模型列表 (Large Model List)**
    - **交互模式**：列表 + 弹窗编辑。
    - **组件**：
        - **列表区**：显示已保存的供应商名称。
        - **操作区**：
            - **新增 (+) / 删除 (-)**：位于列表右上角。
            - **双击编辑**：双击列表项弹出编辑窗口。
    - **弹窗内容 (Dialog)**：
        - 供应商名称（自定义）。
        - API Key（掩码显示）。
        - Base URL（可选）。
        - 模型名称（如 gpt-4, claude-3）。

- **提示词管理 (Prompt Templates)**
    - **交互模式**：列表 + 弹窗编辑。
    - **组件**：
        - **列表区**：显示提示词模板名称。
        - **操作区**：同上（新增/删除/双击编辑）。
    - **弹窗内容 (Dialog)**：
        - 模板名称。
        - 提示词内容（多行文本框）。

#### 4.3.2 右侧区域：策略与系统设置
- **界面外观**：
    - **主题选择**：下拉框选择“明亮模式”或“暗黑模式”。
- **策略监控配置**：
    - 刷新频率设置。
    - 技术指标参数（均线周期等）。
- **通知设置**：
    - 飞书/企业微信 Webhook 配置及测试。

#### 4.3.3 全局影响
- **LLM 对话框增强**：在“交易监控”和“智能选股”页面的 LLM 对话区顶部，新增下拉选框：
    - **选择模型**：从配置好的供应商列表中选择。
    - **选择提示词**：从配置好的模板中选择。

## 5. 扩展性预留
- 界面设计应使用布局管理器 (`QLayout`)，确保在不同分辨率屏幕下的适应性。
- 预留 API 接口，以便未来将 K 线图替换为更专业的第三方图表库。
